---
import Card from "../../components/Card.astro";
import SectionHeader from "../../components/SectionHeader.astro";
import MediaImage from "../../components/media/MediaImage.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ResponsiveGrid from "../../layouts/ResponsiveGrid.astro";
import { getPlaylistsWithResolvedItems } from "../../utils/playlistCollection";

const playlists = await getPlaylistsWithResolvedItems();
---

<BaseLayout sidebar={false} metadataProps={{ title: "Playlists" }}>
  <SectionHeader title="Playlists" padding={true} />
  <ResponsiveGrid gridItemMinWidth="320px" gridType="grid">
    {playlists.map((playlist) => (
      <Card>
        <a class="playlist-card" href={`/playlists/${playlist.slug}/`}>
          {playlist.data.image && (
            <MediaImage
              src={playlist.data.image.src}
              alt={playlist.data.name}
              duration=""
              ratio="video"
              showDuration={false}
              shadow="no-shadow"
              class="playlist-image"
            />
          )}
          <div class="playlist-content">
            <h3>{playlist.data.name}</h3>
            <p>{playlist.data.description}</p>
            <div class="meta">
              <span>{playlist.resolvedItems.length} items</span>
            </div>
          </div>
        </a>
      </Card>
    ))}
  </ResponsiveGrid>
</BaseLayout>

<style>
  .playlist-card {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    text-decoration: none;
    color: inherit;
  }

  .playlist-card:hover h3 {
    color: rgb(var(--accent));
  }

  .playlist-image img {
    width: 100%;
  }

  .playlist-content h3 {
    margin: 0 0 0.35rem;
    font-size: 1.2rem;
  }

  .playlist-content p {
    margin: 0 0 0.5rem;
    color: var(--tx-2);
  }

  .meta {
    font-size: 0.9rem;
    color: var(--tx-3);
  }
</style>

