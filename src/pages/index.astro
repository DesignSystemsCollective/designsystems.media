---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import MediaGrid from "../layouts/MediaGrid.astro";
import VideoCard from "../components/VideoCard.astro";
import LibraryStats from "../components/LibraryStats.astro";

const media = (await getCollection("media"))
  .filter((post) => {
    return !post.data.draft;
  })
  .sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf())
  .slice(0, 30);
---

<BaseLayout sidebar={false}>
  <LibraryStats />
  <h2>Latest media</h2>
  <MediaGrid>
    {
      media.map((media) => (
        <VideoCard
          title={media.data.title}
          poster={media.data.poster}
          duration={media.data.duration}
          slug={media.slug}
          publishedAt={media.data.publishedAt}
        />
      ))
    }
  </MediaGrid>
</BaseLayout>

<style>
  h2 {
    padding: 0;
    margin: 2rem 1rem 0;
    font-size: 1.5rem;
  }
</style>
