---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import MediaGrid from "../layouts/MediaGrid.astro";
import VideoCard from "../components/VideoCard.astro";
import LibraryStats from "../components/LibraryStats.astro";

const media = (await getCollection("media"))
  .filter((post) => {
    return !post.data.draft;
  })
  .sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf());
---

<BaseLayout sidebar={true}>
  <LibraryStats />
  <MediaGrid>
    {
      media.map((media) => (
        <VideoCard
          title={media.data.title}
          poster={media.data.poster}
          duration={media.data.duration}
          slug={media.slug}
          publishedAt={media.data.publishedAt}
        />
      ))
    }
  </MediaGrid>
</BaseLayout>
